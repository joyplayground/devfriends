# 架构设计的初步设想

## 背景

做为一个开发者工具，会继承越来越多的好用的工具进去，所以规模会日趋扩大。复杂度会直线攀升。在这些需求的前提下做设计。

有一句话叫做，设计大型应用的方法就是不要设计大型应用。因此这里采用容器+应用的思路来解决持续开发迭代的问题。

## why not electron

也许以后会考虑，不过现在主要还是想看看 PWA Desktop 的潜力。更多的是验证自己的想法，所以关于这一点不要太认真。

## 架构设计目标

1. 健壮。各个功能模块之间隔离。功能模块和容器模块之间隔离。不会因为部分的不可用而导致整体的不可用。
2. 低内存。尽可能的复用。
3. 快速响应。能够尽可能快的响应用户的交互需求。
4. 开发简单。能够比较低成本的进入开发，不需要太多学习成本。

## 初步设想

![](https://ws4.sinaimg.cn/large/006tKfTcly1g06ywel6e5j30no0podh3.jpg)

1. 应用层。具备独立功能的小应用模块。
2. 门面层。容器底层的 API 的暴漏。
3. 过滤器层。应用调用容器功能的时候，需要经过一层过滤器层。
4. 服务层。无DOM的公共服务层，在 Woker 中执行。
5. 核心层。容器的运行调度控制。

## 一些细节设想

1. 公共的业务逻辑可以抽象为公共的 service
2. UI 相关的，可以采用 client-side render 的方式，在 workder 线程中完成计算，然后发送计算结果到主线程。一次来尽可能的复用。
3. app 可以注册自己的 filter 和 service，但是影响范围只是本身。
4. 需要提供一个全局的 Notify 消息管理机制，一次来通知 APP 一些全局事件。
